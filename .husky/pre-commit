npx lint-staged

# Start test database
echo "ğŸ³ Starting test database..."
docker compose up -d db-test

# Wait for database to be ready
echo "â³ Waiting for database to be ready..."
until docker compose exec -T db-test pg_isready -U postgres > /dev/null 2>&1; do
  sleep 0.5
done
echo "âœ… Database is ready"

# Run tests (stop database on exit regardless of result)
cleanup() {
  echo "ğŸ³ Stopping test database..."
  docker compose stop db-test
}
trap cleanup EXIT

npm run test
